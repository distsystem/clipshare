[workspace]
name = "clipshare"
channels = ["conda-forge"]
platforms = ["linux-64"]
preview = ["pixi-build"]

[dependencies]
clipshare = { path = "." }
clipshare-daemon = { path = "daemon" }

[tasks]
server = "python -m clipshare server"
daemon = "clipshare-daemon"

[feature.build.dependencies]
cargo-zigbuild = ">=0.19"
zig = ">=0.11"

[feature.build.tasks]
release = { cmd = "python scripts/build_release.py", description = "Cross-compile daemon for all targets" }

[environments]
build = { features = ["build"], no-default-feature = true }

# Python server package
[package]
name = "clipshare"
version = "0.2.0" # x-release-please-version

[package.build]
backend = { name = "pixi-build-python", version = "*", channels = ["https://prefix.dev/conda-forge"] }

[package.host-dependencies]
hatchling = "*"

[package.run-dependencies]
python = ">=3.11"
fastapi = "*"
uvicorn = "*"
httptools = "*"
uvloop = "*"
websockets = "*"
aiosqlite = "*"
cryptography = "*"
pydantic = "*"
platformdirs = "*"
zeroconf = "*"
